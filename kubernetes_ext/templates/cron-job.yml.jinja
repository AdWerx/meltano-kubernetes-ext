# Generated by kubernetes_ext and subject to change. Make no modifications. Instead, make
# an overlay and make patches.
apiVersion: batch/v1
kind: CronJob
metadata:
  name: {{ name | tojson }}
  labels:
    "app.kubernetes.io/instance": {{ name | tojson }}
{%- for key, value in labels | dictsort %}
    {{ key | tojson }}: {{ value | tojson }}
{%- endfor %}
spec:
  schedule: {{ cron_interval | tojson }}
  concurrencyPolicy: Forbid
  jobTemplate:
    spec:
      parallelism: 1
      template:
        spec:
          restartPolicy: OnFailure
          volumes:
            - name: scratch
              emptyDir:
                sizeLimit: 1Gi
          containers:
            - name: meltano
              command:
                - meltano
                - {{ cmd }}
{%- for arg in args %}
                - {{ arg }}
{%- endfor %}
              envFrom:
                - configMapRef:
                    name: env
{%- if env %}
              env:
{%- for key, value in env | dictsort %}
                - name: {{ key }}
                  value: {{ value | tojson }}
{%- endfor %}
{%- endif %}
              volumeMounts:
                - mountPath: /tmp
                  name: scratch
